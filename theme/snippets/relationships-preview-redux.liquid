<!--
  RelationShips Preview Redux
  Original Author: Hugh Guiney <hugh@hughguiney.com>
  Body font size for rem calculations: 16px
-->
<style>
  /* Fonts */
  /* @import url('https://fonts.googleapis.com/css?family=Pinyon+Script&display=swap'); */
  @import url('https://fonts.googleapis.com/css?family=Pacifico&display=swap');

  /*
    Maintian aspect ratio for map
    Source: https://css-tricks.com/aspect-ratio-boxes/#article-header-id-6
  */
  .aspect-ratio:before {
    content: "";
    width: 1px;
    margin-left: -1px;
    float: left;
    height: 0;
  }
  .aspect-ratio:after { /* to clear float */
    content: "";
    display: table;
    clear: both;
  }

  .jw-relationships-preview-container {
    margin: 0;
  }

  .jw-relationships-preview,
  [class*="__text"] {
    font-size: 10px;
    font-size: .625rem;
  }

  .jw-relationships-preview {
    box-sizing: border-box;    
    max-width: 100%;
    background-color: #fff8d2;
    line-height: 1.25;
    margin-right: auto;
    padding: .625rem;
    display: flex;
    flex-direction: row;
    min-width: 500px;
    min-width: 31.25rem;
    margin-bottom: 0;
  }
    .jw-relationships-preview.aspect-ratio:before {
      padding-top: calc(3561/4407 * 100%);
    }

    /* Applies to all frames */
    .jw-relationships-preview[class*="jw-relationships-preview--frame"] {
      /* border-image-width: 60px; */
      border-image-width: 3.75rem;
      /* padding: 90px 90px 66.666px; */
      padding: 5.625rem 5.625rem 4.166625rem;
      border-image-outset: 0;
      border-image-repeat: stretch stretch;
      border-style: solid;
    }
    @media only screen and (min-width: 940px) {
      .jw-relationships-preview[class*="jw-relationships-preview--fram"] {
        border-image-width: calc(3.75rem * 1.5);
        padding: calc(5.625rem * 1.5) calc(5.625rem * 1.5) calc(4.166625rem * 1.5);
      }
    }

    /* Gold Trim */
    .jw-relationships-preview.jw-relationships-preview--frame-gold-trim,
    .jw-relationships-preview.jw-relationships-preview--frame-gold-trim-gem,
    .jw-relationships-preview.jw-relationships-preview--frame-gold-trim-small,
    .jw-relationships-preview.jw-relationships-preview--frame-gold-trim-medium,
    .jw-relationships-preview.jw-relationships-preview--frame-gold-trim-large {
      border-image-slice: 470;
      border-image-source: url(https://cdn.shopify.com/s/files/1/1336/0641/files/GoldRatio-Med-Gold-NoRuler-72ppi.png);
    }
      .jw-relationships-preview.jw-relationships-preview--frame-gold-trim-gem {
        border-image-source: url(https://cdn.shopify.com/s/files/1/0263/8148/4080/files/Gem-GoldTrim-Ruler.png?v=1579321684);
      }
      .jw-relationships-preview.jw-relationships-preview--frame-gold-trim-small {
        border-image-source: url(https://cdn.shopify.com/s/files/1/0263/8148/4080/files/Small-GoldTrim-Ruler.png?v=1579321685);
      }
      .jw-relationships-preview.jw-relationships-preview--frame-gold-trim-medium {
        border-image-source: url(https://cdn.shopify.com/s/files/1/0263/8148/4080/files/Medium-GoldTrim-Ruler.png?v=1579321687);
      }
      /* Currently unavailable due to malformed PNG */
      /* .jw-relationships-preview.jw-relationships-preview--frame-gold-trim-large {
        border-image-source: url();
      } */

    /* Light Cherry */
    .jw-relationships-preview.jw-relationships-preview--frame-light-cherry,
    .jw-relationships-preview.jw-relationships-preview--frame-light-cherry-gem,
    .jw-relationships-preview.jw-relationships-preview--frame-light-cherry-small,
    .jw-relationships-preview.jw-relationships-preview--frame-light-cherry-medium,
    .jw-relationships-preview.jw-relationships-preview--frame-light-cherry-large {
      border-image-slice: 460 450 460 450;
      border-image-source: url(https://cdn.shopify.com/s/files/1/1336/0641/files/GoldRatio-Med-Cherry-NoRuler-72ppi.png);
    }
      .jw-relationships-preview.jw-relationships-preview--frame-light-cherry-gem {
        border-image-source: url(https://cdn.shopify.com/s/files/1/0263/8148/4080/files/Gem-LightCherry-Ruler.png?v=1579321681);
      }
      .jw-relationships-preview.jw-relationships-preview--frame-light-cherry-small {
        border-image-source: url(https://cdn.shopify.com/s/files/1/0263/8148/4080/files/Small-LightCherry-Ruler.png?v=1579321683);
      }
      .jw-relationships-preview.jw-relationships-preview--frame-light-cherry-medium {
        border-image-source: url(https://cdn.shopify.com/s/files/1/0263/8148/4080/files/Medium-LightCherry-Ruler.png?v=1579321684);
      }
      /* Currently unavailable due to malformed PNG */
      /* .jw-relationships-preview.jw-relationships-preview--frame-light-cherry-large {
        border-image-source: url();
      } */      

    /* Black Roped */
    .jw-relationships-preview.jw-relationships-preview--frame-black-roped,
    .jw-relationships-preview.jw-relationships-preview--frame-black-roped-gem,
    .jw-relationships-preview.jw-relationships-preview--frame-black-roped-small,
    .jw-relationships-preview.jw-relationships-preview--frame-black-roped-medium,
    .jw-relationships-preview.jw-relationships-preview--frame-black-roped-large {
      border-image-slice: 406 410 406 410;
      border-image-source: url(https://cdn.shopify.com/s/files/1/1336/0641/files/GoldRatio-Med-Black-NoRuler-72ppi.png);
    }
      .jw-relationships-preview.jw-relationships-preview--frame-black-roped-gem {
        border-image-source: url(https://cdn.shopify.com/s/files/1/0263/8148/4080/files/Gem-BlackRoped-Ruler.png?v=1579321681);
      }
      .jw-relationships-preview.jw-relationships-preview--frame-black-roped-small {
        border-image-source: url(https://cdn.shopify.com/s/files/1/0263/8148/4080/Small-BlackRoped-Ruler.png?v=1579321683);
      }
      .jw-relationships-preview.jw-relationships-preview--frame-black-roped-medium {
        border-image-source: url(https://cdn.shopify.com/s/files/1/0263/8148/4080/files/Medium-BlackRoped-Ruler.png?v=1579321684);
      }
      /* Currently unavailable due to malformed PNG */
      /* .jw-relationships-preview.jw-relationships-preview--frame-black-roped-large {
        border-image-source: url();
      } */

    /* Black Walnut */
    /* Comes last to serve as default while other classes are preloaded */
    .jw-relationships-preview.jw-relationships-preview--frame-black-walnut,
    .jw-relationships-preview.jw-relationships-preview--frame-black-walnut-gem,
    .jw-relationships-preview.jw-relationships-preview--frame-black-walnut-small,
    .jw-relationships-preview.jw-relationships-preview--frame-black-walnut-medium,
    .jw-relationships-preview.jw-relationships-preview--frame-black-walnut-large {
      /* border-image-slice: 433 444 433 466; */
      border-image-slice: 84;
      border-image-source: url(https://cdn.shopify.com/s/files/1/0263/8148/4080/files/black-walnut-frame-border-10x10.jpg?v=1581997784);
    }
      .jw-relationships-preview.jw-relationships-preview--frame-black-walnut-gem {
        border-image-source: url(https://cdn.shopify.com/s/files/1/0263/8148/4080/files/Gem-BlackWalnut-Ruler.png?v=1579321685);
      }
      .jw-relationships-preview.jw-relationships-preview--frame-black-walnut-small {
        border-image-source: url(https://cdn.shopify.com/s/files/1/0263/8148/4080/files/Small-BlackWalnut-Ruler.png?v=1579321686);
      }
      .jw-relationships-preview.jw-relationships-preview--frame-black-walnut-medium {
        border-image-source: url(https://cdn.shopify.com/s/files/1/0263/8148/4080/files/Medium-BlackWalnut-Ruler.png?v=1579321687);
      }
      /* Currently unavailable due to malformed PNG */
      /* .jw-relationships-preview.jw-relationships-preview--frame-black-walnut-large {
        border-image-source: url();
      } */

  .jw-relationships-preview__content {
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  [class*="__text"] {
    color: #111;
    text-shadow: .0625rem .0625rem 0 ivory;
    margin: 0 !important;
  }
    @media only screen and (min-width: 940px) {
      [class*="__text"] {
        font-size: .8rem;
      }
    }

  .jw-title {
    text-align: center;
    margin-top: 1rem;
  }
    .jw-title__text {
      font-family: inherit;
      border: none;
      padding: 0;
      font-size: 1rem;
    }
    .jw-title__text.jw-title__text--line2 {
      font-size: .9rem;
    }

  .jw-route {
    /* position: relative; */
    /* height: 2.875rem; */
    display: flex;
    justify-content: space-between;
  }
    .jw-route__origin,
    .jw-route__destination {
      display: inline-block;
      vertical-align: top;
      transition: .125s linear top, .125s linear left, .125s linear right;
      margin-top: 1rem;
    }
    .jw-route__origin {
      text-align: right;
      /* right: 0; */
      padding-right: 1rem;
    }
    .jw-route__destination {
      /* left: 0; */
      padding-left: 1rem;
    }
    /* @media only screen and (min-width: 940px) {
      .jw-route__origin,
      .jw-route__destination {
        top: 125%;
      }
    } */
    /* @media only screen and (min-width: 1200px) {
      .jw-route__origin,
      .jw-route__destination {
        top: 250%;
      }
      .jw-route__origin {
        right: 16%;
      }
      .jw-route__destination {
        left: 16%;
      }
    } */

  .jw-map {
    font-family: 'Pacifico', cursive;
    background-repeat: no-repeat;
    background-size: cover;
    border: .1875rem solid #ad4448;
    min-height: 12.625rem;
    width: 100%;
    /* position: relative; */
    flex: 1;
    display: flex;
    flex-direction: column;
  }
    .jw-map.jw-map--paris-sage {
      background-image: url(https://cdn.shopify.com/s/files/1/1336/0641/files/EuM-Liner-Pari.png);
    }
    .jw-map.jw-map--color-empress-teal {
      background-image: url(https://cdn.shopify.com/s/files/1/1336/0641/files/EuM-Liner-Empr.png);
    }
    .jw-map.jw-map--color-palace-rosa {
      background-image: url(https://cdn.shopify.com/s/files/1/1336/0641/files/EuM-Liner-Pala.png);
    }
    .jw-map.jw-map--color-sea-spray-blue {
      background-image: url(https://cdn.shopify.com/s/files/1/1336/0641/files/EuM-Liner-SeaS.png);
    }
    .jw-map.jw-map--color-mayan-glow {
      background-image: url(https://cdn.shopify.com/s/files/1/1336/0641/files/EuM-Liner-Maya.png);
    }
    .jw-map.aspect-ratio:before {
      padding-top: calc(1151/1850 * 100%);
    }
    .jw-map__group {
      flex: .5;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .jw-map__row {
      position: relative;
      /* border: 2px solid maroon; */
    }
      .jw-map__row + .jw-map__row {
        /* margin-top: .625rem; */
      }
  
  /*
    jw-map height: 333.239px;
    jw-ship height: 261.79px;

    jw-
  */
  .jw-ship {
    text-align: center;
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }
    .jw-ship__image-container {
      width: 100%;
      /* position: absolute; */
      /* bottom: 17%; */
      margin-top: 1rem;
    }
    .jw-ship__image {
      margin: 0 auto; /* !important; */
      display: block;
      width: 50%; /* Default width if imagery → imageClassification is missing */
    }
      /* Jimaworks-made Sail Ship */
      .jw-ship__image.jw-ship__image--jimaworks-made-sail {
        width: 40%;
      }
      /* Jimaworks-made Steam-Sail Ship */
      .jw-ship__image.jw-ship__image--jimaworks-made-steam-sail {
        width: 65%;
      }
      /* Jimaworks-made Steam Ship */
      .jw-ship__image.jw-ship__image--jimaworks-made-steam {
        width: 75%;
      }
      /* Historic imagery - landscape */
      .jw-ship__image.jw-ship__image--historic-landscape {
        width: 55%;
      }
      /* Historic imagery - portrait */
      .jw-ship__image.jw-ship__image--historic-portrait {
        width: 55%;
      }
    .jw-ship__info {
      width: 100%;
      height: 17%; /* Must match `bottom` of .jw-ship__image-container */
      /* position: absolute; */
      /* bottom: 0%; */
      display: flex; /* TODO: vendor prefix */
      flex-direction: column;
      justify-content: center;
      text-align: center;
      margin: 1rem auto;
    }

  .jw-plaque {
    /* border: 3px solid #ad4448; */
    border: .1875rem solid #ad4448;
    background-color: #ecc37e;
    text-align: center;
    max-width: 50%;
    max-height: 4.375rem;
    overflow: auto;
    margin: .625rem auto 0;
    padding: .15625rem;
  }
    .jw-plaque.aspect-ratio:before {
      padding-top: calc(298/640 * 100%);
    }
    @media only screen and (min-width: 940px) {
      .jw-plaque {
        max-height: 5.8333rem;
      }
    }

  .jw-relationships-preview-container [data-tour-spot][id] {
    transition: all .5s linear; /* slow unhighlight */
  }

  .jw-title,
  .jw-route__destination,
  .jw-route__origin,
  /* .jw-ship__image-container, */
  .jw-plaque {
    /* max-width: 75%;
    margin-left: auto;
    margin-right: auto; */
  }
  
  .jw-info {
    box-shadow: 0 0 .625rem #05537a;
    cursor: default;
  }

  .jw-highlighted {
    /* box-shadow: 0 0 10px #05537a; */
    box-shadow: 0 0 .625rem #05537a;
    transform: scale(1.5);
    transition: all .25s linear; /* fast highlight */
    line-height: 1.25;
    z-index: 999999;
  }
    .jw-highlighted.jw-highlighted--alter-box-style {
      padding: .625rem;
      background-color: rgba(255,255,255,0.75);
      border: .0625rem solid #05537a;
    }
    .jw-highlighted.jw-highlighted--retain-size {
      transform: none;
    }

  .jw-relationships-preview-disclaimer {
    font-style: italic;
  }

  /* --- Tour Styles --- */
  /*
    These styles don’t directly apply to the Preview, but to complementary components.
    TODO: Find a better home for them.
  */
  .jw-skip-to-project {
    display: inline-block;
    height: 32px;
    padding: 1px 7px 2px;
    /* background-color: white; */
  }

  .jw-link-button {
    color: white;
    background-color: #0081a3;
    padding: 1rem;
    border-radius: 0.3rem;
    position: relative;
    box-shadow: 1px 1px 2px rgba(0,0,0,0.25);
  }
    .jw-link-button:hover,
    .jw-link-button:focus,
    .jw-link-button:active {
      color: white;
      background-color: #006d8a;
    }
    .jw-link-button:active {
      top: 2px;
      left: 2px;
      box-shadow: 0 0 2px rgba(0,0,0,0.25);
    }

  .jw-more-info-link {
    font-size: 110%;
  }

  /* .jw-modal {} */

  .jw-relationships-tour {
    margin-bottom: 0;
  }
  
  .jw-relationships-tour__actions {
    margin-bottom: .75rem;
  }

  .jw-relationships-tour__content {
    display: flex;
    flex-direction: column-reverse;
    margin-bottom: 3rem;
    margin: 0;
    transition: .125s linear width, .125s linear margin;
    width: 100%;
    max-width: 100%;
  }
    /* .jw-relationships-tour__content.jw-relationships-tour__content--active {} */
    @media only screen and (min-width: 940px) {
      .jw-relationships-tour__content.jw-relationships-tour__content--active {
        flex-direction: row;
        margin: 0 -25%;
        min-width: 90vw;
      }
    }

  .jw-relationships-tour__map {
    flex: 1;
  }

  .jw-relationships-tour__sidebar {
    flex: .5;
    transition: .125s ease height;
    height: 0;
    display: none;
  }
    @media only screen and (min-width: 940px) {
      .jw-relationships-tour__sidebar {
        padding-left: 1rem;
      }
    }
    .jw-relationships-tour__sidebar.jw-relationships-tour__sidebar--active {
      display: block;
      height: auto;
    }

  .jw-relationships-tour__navigation {
    margin-bottom: .75rem;
  }

  .jw-tour {
    height: 0;
    transition: .125s ease height;
    overflow: hidden;
  }
    @media only screen and (min-width: 940px) {
      .jw-tour {
        transition: none;
      }
    }

  .jw-tour__descriptions {
    transition: .125s linear height;
    position: relative;
  }
    .jw-tour__description {
      opacity: 0;
      transition: .125s ease opacity;
      position: absolute;
      top: 0;
    }
    .jw-tour__description.jw-tour__description--active {
      opacity: 1;
      z-index: 999999;
    }

  .--expanded {
    height: 100%;
  }

  .jw-tour__actions {
    position: relative;
    z-index: 9999;
  }
  /* .jw-tour__action {} */
  .--disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .jw-relationships-tour__enter-exit {
    transition: .125s ease width;
  }
</style>
<div class="jw-relationships-preview-container">
  <article
    id="frame"
    class="
      jw-relationships-preview
      jw-relationships-preview--frame-black-walnut
      aspect-ratio
    "
    data-tour-spot
  >
    <div class="jw-relationships-preview__content">
      <div id="map-background" class="jw-map jw-map--paris-sage">
        <div class="jw-map__group">
          <hgroup id="title-text-box" class="jw-title jw-map__row" data-tour-spot>
            <h3 id="title-line1" class="jw-title__text">The Family Crossing: First Generation</h3>
            <h3 id="title-line2" class="jw-title__text jw-title__text--line2" role="presentation">A Thread in the Great Tapistry that is America</h3>
            <h3 id="title-line3" class="jw-title__text jw-title__text--line3" role="presentation"></h3>
          </hgroup>
          <div class="jw-route jw-map__row">
            <div id="destination-text-box" class="jw-route__destination" data-tour-spot>
              <p id="destination-line1" class="jw-route__text">Arrival: A New World Port</p>
              <p id="destination-line2" class="jw-route__text">Destiny: An American Lineage</p>
            </div>
            <div id="origins-text-box" class="jw-route__origin" data-tour-spot>
              <p id="origin-line1" class="jw-route__text">Origin: The Old World</p>
              <p id="origin-line2" class="jw-route__text">Crossing: The North Atlantic</p>
            </div>
          </div>
        </div>
        <div class="jw-ship jw-map__row">
          <div id="ship" class="jw-ship__image-container" data-tour-spot>
            <img id="ship-image" class="jw-ship__image jw-ship__image--jimaworks-made-steam" src="https://cdn.shopify.com/s/files/1/1336/0641/files/jimaworksStPaul640.png" alt="Ship" />
          </div>
          <div id="ship-info-text-box" class="jw-ship__info" data-tour-spot>
            <p id="ship-info-line1" class="jw-ship__text">Typical Ship of this Era: 1200 Passengers</p>
            <p id="ship-info-line2" class="jw-ship__text">Typical Duration of Crossing: Two Weeks</p>
          </div>
        </div>
      </div>
      <div id="webPlaqueTextBoxDiv" class="jw-plaque" data-tour-spot>
        <p id="plaque-line1" class="jw-plaque__text">In Appreciation of</p>
        <p id="plaque-line2" class="jw-plaque__text">the Initiative and Courage of</p>
        <p id="plaque-line3" class="jw-plaque__text">Our Forebears Who First Crossed to America</p>
        <p id="plaque-line4" class="jw-plaque__text">#4</p>
        <p id="plaque-line5" class="jw-plaque__text">#5</p>
        <p id="plaque-line6" class="jw-plaque__text">#6</p>
        <p id="plaque-line7" class="jw-plaque__text">#7</p>
        <p id="plaque-line8" class="jw-plaque__text">#8</p>
      </div>
    </div>
  </article>
  <p class="jw-relationships-preview-disclaimer">Mockup only. Final product may differ in appearance.</p>
</div>
<script>
  console.log( 'RelationShips Preview Redux initialized' );

  var mapElements = {
    "frame": {
      "$element": document.getElementById( 'frame' ),
      "default": localStorage.getItem( 'FrameDefault' ),
      "saved": localStorage.getItem( 'Frame' )
    },
    "mapBackground": {
      "$element": document.getElementById( 'map-background' ),
      "default": localStorage.getItem( 'MapStyleDefault' ),
      "saved": localStorage.getItem( 'MapStyle' )
    },
    "title": {
      "$element": document.getElementById( 'title-text-box' ),
      "fields": ["line1", "line2"],
      "line1": {
        "$element": document.getElementById( 'title-line1' ),
        "default": localStorage.getItem( 'TitleLine1Default' ),
        "saved": localStorage.getItem( 'TitleLine1' )
      },
      "line2": {
        "$element": document.getElementById( 'title-line2' ),
        "default": localStorage.getItem( 'TitleLine2Default' ),
        "saved": localStorage.getItem( 'TitleLine2' )
      }
    },
    "origins": {
      "$element": document.getElementById( 'origins-text-box' ),
      "fields": ["line1", "line2"],
      "line1": {
        "$element": document.getElementById( 'origin-line1' ),
        "default": localStorage.getItem( 'originsTextBoxL1Default' ),
        "saved": localStorage.getItem( 'originsTextBoxL1' )
      },
      "line2": {
        "$element": document.getElementById( 'origin-line2' ),
        "default": localStorage.getItem( 'originsTextBoxL2Default' ),
        "saved": localStorage.getItem( 'originsTextBoxL2' )
      }
    },
    "destination": {
      "$element": document.getElementById( 'destination-text-box' ),
      "fields": ["line1", "line2"],
      "line1": {
        "$element": document.getElementById( 'destination-line1' ),
        "default": localStorage.getItem( 'DestinyLine1Default' ),
        "saved": localStorage.getItem( 'DestinyLine1' )
      },
      "line2": {
        "$element": document.getElementById( 'destination-line2' ),
        "default": localStorage.getItem( 'DestinyLine2Default' ),
        "saved": localStorage.getItem( 'DestinyLine2' )
      }
    },
    "ship": {
      "$element": document.getElementById( 'ship' ),
      "fields": ["image", "infoLine1", "infoLine2"],
      "image": {
        "$element": document.getElementById( 'ship-image' ),
        "default": localStorage.getItem( 'shipPicDefault' ),
        "saved": localStorage.getItem( 'shipPic' )
      },
      "infoLine1": {
        "$element": document.getElementById( 'ship-info-line1' ),
        "default": localStorage.getItem( 'ShipInfoLine1Default' ),
        "saved": localStorage.getItem( 'ShipInfoLine1' )
      },
      "infoLine2": {
        "$element": document.getElementById( 'ship-info-line2' ),
        "default": localStorage.getItem( 'ShipInfoLine2Default' ),
        "saved": localStorage.getItem( 'ShipInfoLine2' )
      }
    },
    "plaque": {
      "$element": document.getElementById( 'webPlaqueTextBoxDiv' ),
      "fields": ["line1", "line2", "line3", "line4", "line5", "line6", "line7", "line8"],
      "line1": {
        "$element": document.getElementById( 'plaque-line1' ),
        "default": "In Appreciation of",
        "saved":  localStorage.getItem( 'PlaqueLine1' ),
      },
      "line2": {
        "$element": document.getElementById( 'plaque-line1' ),
        "default": "the Initiative and Courage of",
        "saved":  localStorage.getItem( 'PlaqueLine2' ),
      },
      "line3": {
        "$element": document.getElementById( 'plaque-line1' ),
        "default": "Our Forebears Who First Crossed to America",
        "saved":  localStorage.getItem( 'PlaqueLine3' ),
      },
      "line4": {
        "$element": document.getElementById( 'plaque-line1' ),
        "default": "#4",
        "saved":  localStorage.getItem( 'PlaqueLine4' ),
      },
      "line5": {
        "$element": document.getElementById( 'plaque-line1' ),
        "default": "#5",
        "saved":  localStorage.getItem( 'PlaqueLine5' ),
      },
      "line6": {
        "$element": document.getElementById( 'plaque-line1' ),
        "default": "#6",
        "saved":  localStorage.getItem( 'PlaqueLine6' ),
      },
      "line7": {
        "$element": document.getElementById( 'plaque-line1' ),
        "default": "#7",
        "saved":  localStorage.getItem( 'PlaqueLine7' ),
      },
      "line8": {
        "$element": document.getElementById( 'plaque-line1' ),
        "default": "#8",
        "saved":  localStorage.getItem( 'PlaqueLine8' ),
      },
    }
  };
  // var $ship = document.getElementById( 'ship' );
  // var $shipImage = $ship.querySelector( '.jw-ship__image' );

  var shipImagery = {
    "jimaworksMade": [
      {
        "imagery": "Savannah_1818-1821_jimaworksmade300ppi.png",
        "imageClassification": "jimaworks-made-steam-sail"
      },
      {
        "imagery": "NieuwAmsterdam_1905-1932_jimaworksmade72ppi.png",
        "imageClassification": "jimaworks-made-steam-sail"
      },
      {
        "imagery": "Maasdam_1952-1968_jimaworksmade72ppi.png",
        "imageClassification": "jimaworks-made-steam-sail"
      },
      {
        "imagery": "Savannah_1962-1972_jimaworksmade72ppi.png",
        "imageClassification": "jimaworks-made-steam-sail"
      },
      {
        "imagery": "jimaworksStPaul640.png",
        "imageClassification": "jimaworks-made-steam"
      },
      {
        "imagery": "Ryndam_1951-1970_-mdlrend.png",
        "imageClassification": "jimaworks-made-steam-sail"
      }
    ],
    "knownShipPlaceholders": [
      {
        "imagery": "EarlySailKnownShipIconLabeled.png",
        "imageClassification": "jimaworks-made-steam-sail"
      },
      {
        "imagery": "ModernSailKnownShipIconLabeled.png",
        "imageClassification": "jimaworks-made-steam-sail"
      },
      {
        "imagery": "SteamSailKnownShipIconLabeled.png",
        "imageClassification": "jimaworks-made-steam-sail"
      },
      {
        "imagery": "ClassicPssgrLinerKnownShipIconLabeled.png",
        "imageClassification": "jimaworks-made-steam-sail"
      },
      {
        "imagery": "PssgrLinerKnownShipIconLabeled.png",
        "imageClassification": "jimaworks-made-steam-sail"
      },
      {
        "imagery": "AgeOfAirTravelKnownPlaneIconLabeled.png",
        "imageClassification": "jimaworks-made-steam-sail"
      },
      // Missing in original dataset:
      {
        "imagery": "Europa_1920-1960_-postcd.jpg",
        "imageClassification": "historic-landscape"
      }
    ]
  };
  var shipImageClassifications = [
    'jimaworks-made-steam-sail',
    'jimaworks-made-sail',
    'jimaworks-made-steam',
    'historic-landscape',
    'historic-portrait'
  ];
  var mapBackgroundColorSchemeToClassId = {
    "ParisSage": "paris-sage",
    "EmpressTeal": "empress-teal",
    "PalaceRosa": "palace-rosa",
    "SeaSprayBlue": "sea-spray-blue",
    "MayanGlow": "mayan-glow"
  };
  var frameStyleToClassId = {
    "BlackWalnut": "black-walnut",
    "GoldTrim": "gold-trim",
    "LightCherry": "light-cherry",
    "BlackRoped": "black-roped"
  };

  function updateFrame( $frame, frameStyle ) {
    applyFrameClasses( $frame, frameStyle );
  }

  function updateMapBackground( $mapBackground, mapBackgroundColorScheme ) {
    applyMapBackgroundClasses( $mapBackground, mapBackgroundColorScheme );
  }

  function updateShipImage( $shipImage, shipImageFileName ) {
    if ( typeof shipImageFileName !== "string" ) {
      shipImageFileName = shipImageFileName.toString();
    }

    var newShipImageClassification = getShipImageClassification( shipImageFileName );

    if ( newShipImageClassification ) {
      $shipImage.src = ( window.Jimaworks.shopifyFilePrefix + shipImageFileName );
      applyShipImageClasses( $shipImage, newShipImageClassification );
    } else {
      console.error( 'Couldn’t get ship image classification for', shipImageFileName );
    }
  }

  function getShipImageClassification( shipImageFileName ) {
    for ( var i = 0; i < shipImagery.jimaworksMade.length; i++ ) {
      var shipImage = shipImagery.jimaworksMade[i];
      
      if ( shipImage.hasOwnProperty( 'imagery' ) && ( shipImage.imagery === shipImageFileName ) ) {
        return shipImage.imageClassification;
      }
    }

    for ( var i = 0; i < shipImagery.knownShipPlaceholders.length; i++ ) {
      var shipImage = shipImagery.knownShipPlaceholders[i];

      if ( shipImage.hasOwnProperty( 'imagery' ) && ( shipImage.imagery === shipImageFileName ) ) {
        return shipImage.imageClassification;
      }
    }

    return null;
  }

  function applyShipImageClasses( $shipImage, shipImageClassification ) {
    var classNameModifierBase = 'jw-ship__image--';
    var classNameModifierBaseRegex = new RegExp( classNameModifierBase );
    var newClassName = ( classNameModifierBase + shipImageClassification );

    if ( classNameModifierBaseRegex.test( $shipImage.className ) ) {
      for ( var index = 0; index < shipImageClassifications.length; index++ ) {
        var className = ( classNameModifierBase + shipImageClassifications[index] );
        
        $shipImage.classList.remove( className );
      }
    }

    $shipImage.classList.add( newClassName );
  }

  function applyMapBackgroundClasses( $mapBackground, mapBackgroundColorScheme ) {
    var classNameModifierBase = 'jw-map--color-';
    var classNameModifierBaseRegex = new RegExp( classNameModifierBase );

    if ( mapBackgroundColorSchemeToClassId.hasOwnProperty( mapBackgroundColorScheme ) ) {
      var mapBackgroundColorSchemeClassId = mapBackgroundColorSchemeToClassId[mapBackgroundColorScheme];
      var newClassName = ( classNameModifierBase + mapBackgroundColorSchemeClassId );

      if ( classNameModifierBaseRegex.test( $mapBackground.className ) ) {
        for ( var currentMapBackgroundColorScheme in mapBackgroundColorSchemeToClassId ) {
          var className = ( classNameModifierBase + mapBackgroundColorSchemeToClassId[currentMapBackgroundColorScheme] );

          $mapBackground.classList.remove( className );
        }
      }

      $mapBackground.classList.add( newClassName );
    } else {
      console.error( 'Unsupported map background color scheme:', mapBackgroundColorScheme );
    }
  }

  function applyFrameClasses( $frame, frameStyle ) {
    var classNameModifierBase = 'jw-relationships-preview--frame-';
    var classNameModifierBaseRegex = new RegExp( classNameModifierBase );

    if ( frameStyleToClassId.hasOwnProperty( frameStyle ) ) {
      var frameStyleClassId = frameStyleToClassId[frameStyle];
      var newClassName = ( classNameModifierBase + frameStyleClassId );

      if ( classNameModifierBaseRegex.test( $frame.className ) ) {
        for ( var currentFrameStyle in frameStyleToClassId ) {
          var className = ( classNameModifierBase + frameStyleToClassId[currentFrameStyle] );

          $frame.classList.remove( className );
        }
      }

      $frame.classList.add( newClassName );
    } else {
      console.error( 'Unsupported frame style:', mapBackgroundColorScheme );
    }
  }

  function getMapElementUpdateFunctionName( mapElementPath ) {
    // ship.image → updateShipImage
    var mapElementPathParts = mapElementPath.split( '.' );
    var updateFunctionName = 'update';

    for ( var index = 0; index < mapElementPathParts.length; index++ ) {
      var mapElementPathPart = mapElementPathParts[index];
      
      updateFunctionName += mapElementPathPart.charAt( 0 ).toUpperCase() + mapElementPathPart.substring( 1 );
    }

    return updateFunctionName;
  }

  function updatePreview( mapElementPath, $element, newValue ) {
    var mapElementUpdateFunctionName = getMapElementUpdateFunctionName( mapElementPath );

    if ( typeof window[mapElementUpdateFunctionName] === 'function' ) {
      window[mapElementUpdateFunctionName]( $element, newValue );
    } else {
      $element.textContent = newValue;
    }
  }

  for ( var mapElementKey in mapElements ) {
    var mapElement = mapElements[mapElementKey];

    if ( mapElement.hasOwnProperty( 'fields' ) && mapElement.fields.length ) {
      for ( var index = 0; index < mapElement.fields.length; index++ ) { // line1, line2, etc.
        var fieldName = mapElement.fields[index];
        var field = mapElement[fieldName];
        var mapElementPath = mapElementKey + '.' + fieldName;

        if ( field.saved && ( field.saved !== field.default ) ) {
          updatePreview( mapElementPath, field.$element, field.saved );
        }
      }
    } else {
      if ( mapElement.saved && ( mapElement.saved !== mapElement.default ) ) {
        updatePreview( mapElementKey, mapElement.$element, mapElement.saved );
      }
    }
  }
</script>